1. 某车站售票厅，任何时刻最多可容纳 20 名购票者进入，当售票厅中少于 20 名购票者时，厅外的购票者可立即进入，否则需在外面等待。若把一个购票者看作一个进程，请回答下列问题：

(1) 用 PV 操作管理这些并发进程时，应怎样定义信号量，写出信号量的初值以及信号量各种取值的含义。

(2) 根据所定义的信号量，使用 P、V 操作保证进程能够正确地并发执行。

(3) 若欲购票者最多为 n 个人，写出信号量可能的变化范围 (最大值和最小值)。

答：（1）

Semaphore full=20;                                    

①0<full<20 时，售票厅中人数为 20-full（人）          

②full=0 时，售票厅中人数为 20 人，即售票厅满         

③full<0 时，厅外等候进入售票厅的人数为|full|人        

（2）

Process Customeri

{ 

  P (full);                

 进入购票；离开售票厅；

  V (full);                

}

（3）

(20-n) ≤ full ≤ 20      

2. 设正在处理器上执行的一个进程的页表如表 4 所示。页表的页号和物理块号是十进制数，起始页号 (块号) 均为 0；所有的地址均是存储器字节地址，页的大小为 1024 字节。（注：状态位表示该页是否在内存，1—在，0—不在；）下列逻辑地址对应什么物理地址：(1) 5499； (2) 2221；表 4

|   |   |   |   |   |
|---|---|---|---|---|
|页号|状态位|访问位|修改位|物理块号|
|0|1|1|0|4|
|1|1|1|1|7|
|2|0|0|0|---|
|3|1|0|0|2|
|4|0|0|0|---|
|5|1|0|1|0|

答：（1）5499/1024=5 余数为 379，故页号为 5（查页表得对应物理块号为 0，页内地址为

379，物理地址=0*1024+379=379 

（2）2221/1024=2 余数为 173，故页号为 2，页内地址为 173，查页表得 2 号页对应物理块号为空，即 2 号页不在内存中，所以物理地址不存在。

3. 有一矩阵 int A[100][100] ；以行为优先进行存储。计算机采用虚拟存储系统，物理内存共有 3 块，其中一块存放程序，其余两块存放数据。假设程序已在内存中占一块, 其余两块空闲。

|   |   |
|---|---|
|程序 A:<br><br>for（ i=0; i<100;i++） for(j=0；j<100;j++)<br><br>A[i][j]=0;|程序 B:<br><br>for（ j=0; j<100;j++） for(i=0；i<100;i++)<br><br>A[i][j]=0;|

若每块可存放 200 个整数，程序 A 和程序 B 的执行过程各会发生多少次缺页？若每页只能存放 100 个整数呢？以上说明了什么问题？答: (1) 每个主存块的大小可以存放 200 个数组元素，有两个内存块可以用来存放数组信息，数组中的元素按行编址。显然，对于程序 A，数组的存储顺序与访问顺序一致，每访问两行数组遇到一次缺页中断，共产生 50 次缺页中断；对于程序 B，数组的存储顺序（按行的顺序）与访问顺序（按列的顺序）不一致，每访问两个数组元素遇到一次缺页中断，共会产生

5000 次缺页中断。

(2) 若每页只能存放 100 个整数，对于程序 A，数组的存储顺序与访问顺序一致，每访问一行数组遇到一次缺页中断，会产生 100 次缺页中断。对于程序 B，数组的存储顺序（按行的顺序）与访问顺序（按列的顺序）不一致，每访问一个数组元素遇到一次缺页中断，会产生

10000 次缺页中断。

以上结果说明：1. 缺页的次数与内存中数据存放的方式及程序的执行顺序有很大关系。

2. 当缺页中断的次数不多时，减小页面的大小对缺页次数的影响不大；但当缺页中断的次数很多时，减小页面的大小对缺页次数有很严重的影响。

4. 假设目前有 6 个读写磁盘的请求如表 5 所示：表 5

|   |   |   |   |
|---|---|---|---|
|请求次序|柱面号|磁头号|扇区号|
|1|180|7|1|
|2|30|7|2|
|3|12|9|10|
|4|40|2|1|
|5|35|4|8|
|6|90|9|11|

假定当前移动臂位置在 20 号柱面，移动方向是向大于 20 号柱面的方向移动。试问：

（1）       采用电梯调度算法（scan），上述请求的访问次序为何？ 

（2）       如果所有请求的柱面号相同，上述请求的最短寻道时间优先（sstf）次序为何？  答：（1）2,5,4,6,1,3    

（2）3,2,5,4,6,1     

5. 有两个用户进程 A 和 B, 在运行过程中都要使用系统中的一台打印机输出计算结果.

(1)    试说明 A, B 两进程之间存在什么样的制约关系 

(2)    为保证这两个进程能正确地打印出各自的结果, 请用信号量和 P, V 操作写出各自的有关申请, 使用打印机的代码. 要求给出信号量的含义和初值. 

答：(1) A, B 两进程之间存在互斥制约关系. 因为打印机属于临界资源, 必须一个进程使用完之后另一个进程才能使用.

(2) mutex: 用于互斥的信号量, 因为只有一台打印机, 所以初值为

|   |   |
|---|---|
|进程 A|进程 B|
|......<br><br>P (mutex);<br><br>使用打印机;<br><br>V (mutex);<br><br>……|......<br><br>P (mutex);<br><br>使用打印机;<br><br>V (mutex);<br><br>……|

6. 现有一作业，在段式存储管理的系统中已为主存分配了如表所示的段表。

|   |   |   |
|---|---|---|
|段号|段长|主存起始地址|
|0|700|1780|
|1|180|1020|
|2|220|1580|
|3|910|2820|
|4|1500|1650|

计算该作业访问[0,600],[1,400],[2,286],[3,755][4,960]时的绝对地址。（方括号中第一个元素为段号，第二个元素为段内地址）。

答：(1) [0,600]：因为 600＜700，所以绝对地址＝1780+600＝2380。

(2)    [1,400]：因为 400＞180，所以该逻辑地址越界，系统发出“越界中断”。

(3)    [2,286]：因为 286＞220，所以该逻辑地址越界，系统发出“越界中断”。

(4)    [3,755]：因为 755＜910，所以绝对地址＝2820+755＝3575。

(5)    [4,960]：因为 960＜1500，所以绝对地址＝1650+960＝2610。

7. 在一个采用页式虚拟存储管理的系统中, 有一用户作业, 它依次要访问的地址序列是: 115,228,120,88,446,102,321,432,260,167, 若该作业的第 0 页已经装入主存, 现分配给该作业的主存共 300 B, 页的大小为 100 B, 请回答下列问题: 

(1) 页面请求序列。

(2) 按 FIFO 调度算法将产生 (  ) 次缺页中断,依次淘汰的页号为 (  ) ,缺页中断率为 (  ) . 

(3) 按 LRU 调度算法将产生 (  ) 次缺页中断,依次淘汰的页号为 (  ) ,缺页中断率为 (  ) .  答：

(1) 根据地址序列求出页面访问序列：

115/100=1，228/100=2，120/100=1，88/100=0，446/100=4，102/100=1，321/100=3，432/100=4， 260/100=2，167/100=1。故页面访问序列为：1，2，1，0，4，1，3，4，2，1. 

(2) 按 FIFO 调度算法将产生 5 次缺页中断（1 分） ;依次淘汰的页号为: 0,1,2;  缺页中断率为: 5/10=50%

(2) 按 LRU 调度算法将产生 6 次缺页中断（1 分）; 依次淘汰的页号为: 2,0,1,3;  缺页中断率为: 6/10=60%

8. 某系统有 R 1, R 2, R 3 共 3 种资源，在 T 0 时刻 P 1, P 2, P 3, P 4 这 4 个进程对资源的占用和需求如下，系统的可用资源向量为（2，1，2）

|   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|
|进程||最大需求|   ||占有量||
|R 1|R 2|R 3|R 1|R 2|R 3|
|P 1|3|2|2|1|0|0|
|P 2|6|1|3|4|1|1|
|P 3|3|1|4|2|1|1|
|P 4|4|2|2|0|0|2|

（1）将系统中各种资源的总和及此刻各进程对资源的需求数目用向量或矩阵表示出来。（2）如果此时 P 1 和 P 2 均发出资源请求向量（1，0，1），为了保持系统安全性，应如何分配资源给这两个进程。答：

（1）       各类资源总和: [R 1, R 2, R 3]=[ 9,3,6] 各进程对资源的需求数目: 

  2  2  2

  2  0  2

1  0  3 

4  2  0  

（2）       当将资源分配给 P 1 后，需求矩阵为：

1     2  1

2     0  2

1  0  3

4  2  0 

系统可利用资源为：1  1  1  故此时不存在安全序列，系统处于不安全状态，所以 P 1 进程的资源请求不能满足。

当将资源分配给 P 2 后，需求矩阵为：

2  2  2

1  0  1

1  0  3

4  2  0

系统可利用资源为：1  1  1 故此时存在安全序列 P 2, P 3, P 4, P 1，所以 P 2 进程的资源请求可以满足。

9. 以下进程之间存在相互制约关系吗？若存在，是什么制约关系？为什么？

（1）       几个同学去图书馆借同一本书。

（2）       篮球比赛中两队同学抢篮板球。

（3）       果汁流水线生产中捣碎、消毒、罐装、装箱等各道工序。

（4）       商品的入库和出库。

（5）       工人做工和农民种粮。

（6）       多人（大于两人）来理发店找两个理发师理发。

答：（1）互斥，一本书只能由一人借

（2）       互斥，篮球比赛中篮球只能由一人持球

（3）       同步，流水线上各工序之间是顺序关系

（4）       同步，入库与出库之间是顺序关系

（5）       没关系

（6）       既同步又互斥，顾客来理发店与理发师理发是同步，多个顾客与两个理发师之间是互斥