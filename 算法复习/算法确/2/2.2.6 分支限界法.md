---
tags:
  - Algorithm
doc_type: 笔记卡片
aliases:
  - 数组位移
finished: true
creation: 2024-11-09T18:29:00
modification: 2024-11-08T18:30:00
description: 
review-frequency: low
---
---

```
path:"算法复习/算法确/2/" 分支限界法
```

>[!question] 
>**提示**：
>1. **问题或概念**：  
>   - 请分析**什么是分支限界法？**，并通过分支限界法中的 LC-BB 算法对 **0-1 背包问题**进行说明，使用中文。
>2. **分析框架**：  
>   - 请分解成具体的步骤，并嵌入**分支限界法的基本思想**。对于每个步骤，说明如何体现**分支限界法**的基本思想，并用具体的例子来帮助理解。
>3. **要素强调**：  
>   - 在解释过程中，请重点讲解**分支限界法的基本思想**，并通过**0-1 背包问题**中的每个阶段体现出来。
>4. **举例**：  
>   - 请提供**0-1 背包问题的背景和算法**，展示如何通过**分支限界法**的每一步逐渐达到最优解。

>[!important]  回溯法与分支限界法

[2.2.5 回溯](2.2.5%20回溯.md)
#### 13. **回溯法与分支限界法之间的相同点是什么？不同之处在哪些方面？**

- **问题分析**：回溯法与分支限界法都用于解决组合优化问题，具有一些相似的结构，但在解法和策略上有显著不同。
  - **相同点**：两者都构造出解空间树，并在该树上进行搜索，以寻找最优解。
  - **不同点**：
    - **回溯法**：采用深度优先搜索策略，逐步探查各分支并在不满足条件时返回（称为“回溯”），以避免不必要的计算。
    - **分支限界法**：采用广度优先搜索或优先级策略，选择最有潜力的分支继续探索，并用剪枝技术去除无潜力的分支。

- **知识点拓展**：
  - **剪枝策略**：回溯法和分支限界法都可以通过剪枝优化搜索效率，但在分支限界法中，更依赖优先级和限界函数来判断哪些分支更有潜力。

- **理解与记忆**：
  - 回溯法如深潜，需要对每条路径进行探索，发现行不通的路便折返；而分支限界法像广域搜索，优先寻找看起来更有潜力的路径。

#### 14. **分支限界法基本思想是什么？**

- **问题分析**：分支限界法的核心思想是通过在解空间树上构建和剪枝以找到最优解。在构建的同时，优先扩展有潜力的节点，避免无效的计算。
  - **基本步骤**：
    - 使用广度优先策略，或基于节点的优先级（如最小代价）来扩展分支。
    - 在每个节点上构建所有子节点并判断它们的潜力，剪去无法产生更优解的分支。

- **知识点拓展**：
  - **优先队列**：分支限界法通常用优先队列来记录当前最有潜力的节点，帮助算法更快地找到最优解。

- **理解与记忆**：
  - 分支限界法类似图书馆管理员按优先级整理书籍，管理员首先处理最相关的书，避免去查找那些明显不符合需求的书籍。


#### 18. **常见的两种分支限界法是什么？**

- **问题分析**：分支限界法有两种主要实现方式，即“队列式”和“优先队列式”。这两种方式使用不同的队列管理策略来控制节点的选择顺序。
  1. **队列式 (FIFO)**：采用先进先出原则，类似排队买票，先来的节点先被处理。
  2. **优先队列式**：根据节点的优先级来选择扩展的节点，优先处理有更大潜力的节点。优先队列式的策略类似急诊室先处理重症患者，确保更有希望的分支优先扩展。

- **知识点拓展**：
  - **优先级队列实现**：优先队列通常基于节点的潜力值（如最低代价或最大收益）来管理节点的顺序。

- **理解与记忆**：
  - 队列式可以类比为“先来先服务”的排队模式，而优先队列式更像一个“急诊优先”的队列，总是优先处理最有希望的节点。

---
---

在分支限界法（LC-BB）中的 **upper bound** 和 **cost** 的计算方式。你所表达的这两个状态是对 0-1 背包问题中 **上界**（upper bound）和 **实际成本**（cost）的不同表示。让我们详细分析这两个状态。

### 1. **Upper Bound（上界）**：
   - **公式**：$u = \sum_{i=1}^{n} p_i w_i$  
     其中：
     - $p_i$ 是物品 $i$ 的利润。
     - $w_i$ 是物品 $i$ 的重量。
     - 上界,计算当前已选择的物品的实际利润。
     - 计算时，不能选择部分物品。

   - **应用**：
     - 通过 **upper bound** 我们可以估算当前节点的最大可能利润，并且如果发现某个节点的上界已经小于当前最优解的上界（或成本），那么这个节点就可以剪枝掉，避免浪费时间继续探索无效分支。

### 2. **Cost（实际成本）**：
   - **公式**：$c = \sum_{i=1}^{n} p_i w_i$（可以拆分，考虑部分物品）
   -  $c$ 表示的是当前状态下背包可能的最大利润，但是它是一个估算值。
   -  计算时，可以选择部分物品（即贪心策略），计算所有物品的最大可能利润，但不能超过背包的剩余容量。

### **分支限界法中的使用**：
- **Upper Bound**（上界）是我们当前路径的实际收益，表示当前已经选择的物品的利润。在回溯或者搜索过程中，**Upper Bound**是用来判断当前路径的好坏的依据。

- **Cost**（实际成本）用于估算当前节点可能的最大收益，帮助我们在求解过程中进行剪枝。通过上界来判断某些分支是否可以提前终止（剪枝），如果某个节点的上界小于当前已知最优解的 **Upper Bound**，则可以忽略这个节点。

### 计算过程举例：
假设背包容量为 15，物品的利润和重量如下：
- 物品 1：利润 = 10，重量 = 2
- 物品 2：利润 = 10，重量 = 4
- 物品 3：利润 = 12，重量 = 6
- 物品 4：利润 = 18，重量 = 9

#### 第一层状态：
- **Cost**：如果选择物品 1、物品 2 和物品 3，总利润为：
$$
  \text{Cost} = 10 + 10 + 12 +6= 38（-38）
$$
  物品 4 由于超出容量（15-2-4-6 = 3，物品 4 的重量为 9）放入物品 4 的部分利润 至背包容量 15。

- **Upper Bound**：对于物品 1、物品 2 和物品 3，总利润为：
$$
  \text{Upper Bound} = 10 + 10 + 12 = 32（-32）
$$
 在剩余容量 3 的情况下，物品 4 无法放入，所以上界即为 -32。

#### 第二层状态：
- 假设选择物品 1 和物品 2。
- **Cost**：选择物品 1 和物品 2 的总利润为：
$$
  \text{Cost} = 10 + 10 + 12 +6= 38（-38）
$$
  
- **Upper Bound**：继续估算可以放入的物品，剩余容量为 9。选择物品 3 和物品 4：
$$
  \text{Upper Bound} = 10 + 10 + 12 = 32（-32）
$$
  物品 4 由于超出容量（15-2-4-6 = 3，物品 4 的重量为 9），物品 4 无法放入。

#### 最终选择：
- 经过各层的分支和剪枝，最终选择物品 1、物品 2 和物品 4，并且总利润为 38，总重量为 15，正好填满背包。

### **总结**：
- **Cost** 计算的是当前路径假设可以选择部分物品的利润。
- **Upper Bound** 是计算当前节点实际利润，即不包括拆分物品的部分利润。
- 在 **分支限界法** 中，通过不断更新 **upper bound** 和 **cost** 来引导搜索方向，并剪枝不可能带来最优解的分支。

---

在 **0-1 背包问题** 中，**分支限界法**（LC-BB）通过创建子树来逐步探索不同的物品选择组合。在每个节点处，我们计算 **上界**（upper bound）和 **实际成本**（cost），然后决定是否继续探索该节点或进行剪枝。以下是创建子树的过程以及如何计算 **upper bound** 和 **cost** 的示例。

### 子树建立过程

#### 背包问题设置：
- 背包最大容量为 15
- 物品有四个，分别为：
  - 物品 1：利润 10，重量 2
  - 物品 2：利润 10，重量 4
  - 物品 3：利润 12，重量 6
  - 物品 4：利润 18，重量 9

#### 子树的构建

每个节点表示一个背包的状态，记录了已选择的物品和当前背包的容量剩余。我们通过 **0-1 决策树**来逐步探索每个物品是否应该被放入背包。

### 初始状态（根节点）

在根节点（空背包）下，我们没有选择任何物品，背包的容量为 15。

| 物品编号 | 利润  | 重量  | 当前背包容量 | 当前成本 (Cost) | 上界 (Upper Bound)  | 是否选择 |
| ---- | --- | --- | ------ | ----------- | ----------------- | ---- |
| 物品 1 | 10  | 2   | 15     | -38         | 10 + 10 + 12 =-32 | ?    |

#### 下一步：
1. **选择物品 1**：选择物品 1 后，背包剩余容量为 13。
2. **不选择物品 1**：继续向下探索。

### 第一层子树（选择或不选择物品 1）

#### 子树 1（选择物品 1）
- **当前背包容量**：15 - 2 = 13
- **当前成本**：10
- **上界**：我们接着计算如果选择了物品 1，剩余背包容量 13，继续选择物品。

| 物品编号 | 利润  | 重量  | 当前背包容量 | 当前成本 (Cost) | 上界 (Upper Bound)  | 是否选择 |
| ---- | --- | --- | ------ | ----------- | ----------------- | ---- |
| 物品 1 | 10  | 2   | 13     | -38         | 10 + 10 + 12 =-32 | 选中   |
| 物品 2 | 10  | 4   | 13     | -38         | 10 + 10 + 12 =-32 | ?    |

- **计算成本**：假设接下来可以选择物品 2 和物品 3 的全部利润和物品 4 部分利润。
$$
  \text{Cost} = 10 + 10 + 12 +6= 38（-38）
$$
- **计算上界**：假设接下来可以选择物品 2 和物品 3 的部分重量。物品 4 因容量不足不能选择。
$$
  \text{Upper Bound} = 10 + 10 + 12 = 32（-32）
$$

#### 子树 2（不选择物品 1）
- **当前背包容量**：15
- **当前成本**：0
- **上界**：我们接着计算如果不选择物品 1，剩余容量仍为 15。

| 物品编号 | 利润  | 重量  | 当前背包容量 | 当前成本 (Cost) | 上界 (Upper Bound) | 是否选择 |
| ---- | --- | --- | ------ | ----------- | ---------------- | ---- |
| 物品 1 | 10  | 2   | 15     | -32         | 10 + 12 =-22     | 不选   |
| 物品 2 | 10  | 4   | 15     | -32         | 10 + 12 =-22     | ?    |

- **计算成本**：假设接下来可以选择物品 2 和物品 3 的全部利润和物品 4 部分利润。
$$
  \text{Cost} = 10 + 12 +12= 32（-32）
$$
- **计算上界**：假设接下来可以选择物品 2 和物品 3 的部分重量。物品 4 因容量不足不能选择。
$$
  \text{Upper Bound} = 10 + 12 = 22（-22）
$$

### 进一步的子树探索

随着树的不断展开，我们会进入更深层次的子树。在每一层，我们将根据是否选择某个物品来更新当前的背包容量、已选择物品的利润（cost）以及上界（upper bound）。在每个节点的选择上，我们都通过计算 **upper bound** 来判断该分支是否有潜力产生更优的解，如果上界小于当前已知的最优解，则进行 **剪枝**。

### 关键步骤：

1. **Upper Bound 计算**：当我们到达某个节点时，我们计算上界，通过贪心策略将剩余空间填满。如果上界已经小于当前最优解的成本，就可以进行剪枝，避免不必要的搜索。
2. **Cost 计算**：我们记录当前已选择物品的总利润。**Cost** 是用来评价当前路径的好坏的关键指标。
3. **剪枝**：如果当前路径的上界小于或等于当前最优解（即已经找到的最优解），我们就可以剪枝，避免继续深入。

### 最优解的选择

最终，当我们选择物品 1、物品 2 和物品 4 时，总利润为 **38**，背包正好装满，总重量为 **15**，这是一个最优解。



---


从您的描述中，我发现了一些问题和需要更正的地方，特别是在 **Cost** 和 **Upper Bound** 的计算公式和逻辑上。接下来我将按步骤重新分析和修正。

### 1. **物品与背包问题设置**
- 背包最大容量 = 15
- 物品列表：
  - 物品 1：利润 = 10，重量 = 2
  - 物品 2：利润 = 10，重量 = 4
  - 物品 3：利润 = 12，重量 = 6
  - 物品 4：利润 = 18，重量 = 9

### 2. **根节点（初始状态）**
根节点表示初始状态：没有物品放入背包，背包容量为 15。

#### **Cost**（当前实际成本）：
此时没有选择任何物品，所以 **Cost = 0**。

#### **Upper Bound**（上界计算）：
- 物品选择顺序按照每单位重量的利润（即利润/重量比）来选择。我们按照这个顺序来尝试填充背包，直到背包满或者不能再放更多物品。
- **物品 1**（利润 = 10，重量 = 2），利润/重量比 = 5
- **物品 2**（利润 = 10，重量 = 4），利润/重量比 = 2.5
- **物品 3**（利润 = 12，重量 = 6），利润/重量比 = 2
- **物品 4**（利润 = 18，重量 = 9），利润/重量比 = 2

按照这个顺序，首先放入物品 1（剩余容量 13）、物品 2（剩余容量 9）、物品 3（剩余容量 3）。此时剩余 3 的容量无法容纳物品 4，所以只能放入部分物品 4。

- **上界的计算**：  
  假设我们选择了物品 1、物品 2 和物品 3 后，剩余容量 3 不能容纳物品 4，所以下界为：
  \[
  \text{Upper Bound} = 10 + 10 + 12 + \frac{3}{9} \times 18 = 10 + 10 + 12 + 6 = 38
  \]

### 3. **第一层子树（选择物品 1 和不选择物品 1）**

#### 子树 1：选择物品 1（剩余容量 13）
- **Cost**（当前成本）：当前选择了物品 1，总利润为 10。
- **Upper Bound**（上界计算）：
  - 物品 2、物品 3、物品 4 按照利润/重量比继续选择。剩余容量 13：
  - 选择物品 2（剩余容量 9）和物品 3（剩余容量 3）。物品 4 因容量不足无法选择。
  - **上界计算**：
  \[
  \text{Upper Bound} = 10 + 10 + 12 + \frac{3}{9} \times 18 = 10 + 10 + 12 + 6 = 38
  \]

#### 子树 2：不选择物品 1（剩余容量 15）
- **Cost**（当前成本）：没有选择物品 1，总利润为 0。
- **Upper Bound**（上界计算）：
  - 选择物品 2、物品 3、物品 4 按照利润/重量比继续选择。剩余容量 15：
  - 选择物品 2（剩余容量 11）、物品 3（剩余容量 5），物品 4（剩余容量 0）。
  - **上界计算**：
  \[
  \text{Upper Bound} = 10 + 10 + 12 + 18 = 50
  \]

### 4. **第二层子树（选择物品 2 或不选择物品 2）**

#### 子树 1：选择物品 2（剩余容量 9）
- **Cost**：选择物品 2，总利润为 10。
- **Upper Bound**：继续选择物品 3（剩余容量 3），物品 4（剩余容量 0）无法选择。
  \[
  \text{Upper Bound} = 10 + 12 + \frac{3}{9} \times 18 = 10 + 12 + 6 = 28
  \]

#### 子树 2：不选择物品 2（剩余容量 15）
- **Cost**：不选择物品 2，总利润为 0。
- **Upper Bound**：继续选择物品 3（剩余容量 9）和物品 4（剩余容量 0）。
  \[
  \text{Upper Bound} = 12 + 18 = 30
  \]

### 5. **剪枝**
根据以上的计算，当子树的上界小于当前最优解时，可以进行剪枝。例如，当选择物品 2 和物品 3 时，若其上界为 28（小于当前最优解 38），则该分支可以剪枝。

### 6. **最终解**
- 最优解是选择物品 1、物品 2 和物品 4，总利润为 38，总重量为 15。
- 背包正好装满，符合最大化利润的目标。

### 总结

在使用 **分支限界法**（LC-BB）时，核心的操作是计算每个节点的 **Cost** 和 **Upper Bound**，并使用 **Upper Bound** 来判断是否剪枝。通过贪心策略估算 **Upper Bound**，可以快速排除不可能产生最优解的分支，从而提高求解效率。在本例中，最终选择物品 1、物品 2 和物品 4，总利润为 38，背包容量为 15，达到了最优解。

如果有其他问题或不清楚的地方，请随时告知！